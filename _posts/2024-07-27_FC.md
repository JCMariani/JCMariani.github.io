---
layout: post
title: Principle of Functional Connectivity
subtitle: From the neuronal network to brain dynamics
cover-img: /assets/img/post-00_RS_FC.png
thumbnail-img: /assets/img/post-00_RS_FC_thumb.png
share-img: /assets/img/post-00_RS_FC.png
tags: [theory, neuroimaging, functional connectivity]
author: JC Mariani
---

This post is adapted from the introduction of my PhD thesis. Full version can be find [here](https://theses.hal.science/tel-04420129).

# Functional Connectivity

As we described earlier, the field of neuroimaging inherits from late XIX<sup>th</sup> century advances in physiology and neurosciences. It relies on successive fundamental findings in the physiology of brain cells, coupled with technological advances that allowed to measure their activity. These advances have highlighted the existence of an integrative neuronal network whose understanding bloomed during the XX<sup>th</sup> century. This sections presents how, from the network essence of brain structure, functional connectivity has been operatively defined as the measure of covariance in haemodynamic signals \cite{Friston_93}.

## Principle

### The neuronal network


In its lectures from the $$30s$$, \cite{Sherrington_1934} describes the neuronal organisation complexity. In this description, the brain and its constitutive neurons are the centre of movement control and sensory integration. *Sherrington* argues that a combination of excitatory and inhibitory neurons entangled in a complex fashion gives rise to the diversity of behaviours observed in animals. A key component in *Sherrington*'s description is the "patterned" nature of neuronal network. As surprising as it may seem, the neuronal network dynamical essence is already described. Overall, *Sherrington* describes a vast collection of excitatory and inhibitory neurons whose rule of connection and its evolution in time is the source of behaviour. 


Later on, neurophysiologists focalised on understanding the rules which govern the neuronal network. A main actor in this effort has been *Donald Hebb* with his famous *Hebbian law* which is usually stated as: "What fire together wire together". This concept is probably underlying most of the work on neuronal plasticity and remains a central concept in the study of memory. By this description, *Hebb* gives an insight of how the coupling strength between nodes in the network encodes information, and a simple rule of its evolution which through the integrative property of the network can explain complex principles as memory consolidation or loss.


<img src="https://JCMariani.github.io/assets/img/post-00_Intro_network.svg" alt="drawing" width="15%" class="center"/>

^**Fig1.** Illustration of the neuronal network from \cite{Getting_1989}. Left: individual building blocks of the network (triangle: excitation, dots: inhibition). Right: disctinction between anatomical and functional networks. Top: Example of anatomical network in \emph{Tritonia} escape swiming network. Bottom: two examples of functional network, whether *C2* is deactivated or not.^


Another seminal piece of work comes from *Vernon Mountcastle* whose network structure and dynamics description is summarised in \cite{Mountcastle_1978}. In this review, after introducing the evolutionary meaning of such construct *Mountcastle* describes the cortical column as the functional unit of the neocortex. Microcolumns are vertical juxtaposition of neuronal cells across layers resulting in a cylinder of $$\sim30\mu m$$ diameter for a $$2500\mu m$$ height (for a volume containing approximately $$110$$ cells). He argues based on data from the different cortical regions that the cortex is composed of a mosaic of such microcolumns which reproduce the same circuit. Although, they must not be seen as isolated one from the others, but as an horizontally connected network, even though vertical connections prevail. In the end, the micro columns can be clustered together into minicolumns ($$\sim 500\mu m$$ of diameter) that are commonly associated to function. Without going too much in the details of his findings, a key message *Mountcastle* gives in his discussion is, the modular structure of brain network. By describing the cortex as this assembly of parallel processing units he defines the brain as a distributed network. Scale invariance of an integrative brain model is at the heart of this description. Micro modules build mini modules which make cortical areas. Once again, he concludes by highlighting the dynamical nature of such a network.


\cite{Gerstein_1989} integrates these three historical physiological breakthroughs, and others, to define the concept of "neuronal assembly". In his review he emphasises the abstraction level of this concept. It is such abstractions which are well vulgarised in \cite{changeux_2006}, where *concepts* and *percepts* interact in their physical substract that is the neuronal network. This framework is also formalised in \cite{Getting_1989}. Here, a *hardwire* hypothesis is used, which stipulates that physical connections, or the anatomical network, is assumed fixed. This anatomical network can be described at the lowest level by *building blocks* (typical connections between $$2$$ to $$3$$ neurons). *Getting* argues that from the same network, multiple functions can arise based on modulation of the building block. By tuning the activity of the building blocks, the same elemental bricks can behave differently at the network level. It justifies again the efficiency of such an architecture in engendering complex behaviours in an economic way. Such modulation of the network defines *modes*. "*Each mode represents the functional organisation of the network that gives rise to a function or task*". Finally, in this set of neurons interconnected in a specific mode, at any given time (where the timescale must be defined) the activated part of the network defines a *state*. Past this formal description, \cite{Getting_1989} also describes the practical aspect of measuring such neuronal assemblies. This work with all the studies it inspires from probably build the fundamental bases of modern brain connectomics. Since then models have been proposed to explain resilience of the network and optimised energetic expenditure, among them the small world hypothesis \cite{Bassett_2006} seems quite consensual.


###The functional network}


 Based on the \emph{Hebbian} principle, if two neurons possess some synchronicity in their firing pattern, one can assume that they are connected. Formally \cite{Gerstein_1989} defines appartenance to a neuronal assembly by the correlation in neurons firing pattern, it is called \emph{functional connectivity}. As an extension, the connection direction can be assessed by looking at delays in the correlation. In this framework, \emph{effective connectivity} is defined by a weight matrix $W$ such as $x_j = \sum_{i}W_{ij}x_i$ where $x_i$ represents the activity of a single neuron. It is precised in \cite{Gerstein_1989} that $W$ is usually non symmetrical for brain processes. 
 
In \cite{Friston_93} the operational limit of such framework is presented. Indeed, recordings of neuronal spike trains are limited in terms of units that could be recorded at the same time. As a result, intermediary polysynaptic pathways are missed or can only be hypothesised. Therefore the principle is generalised and functional connectivity defined as \guillemotleft \emph{the
observed temporal correlation between two electro/neurophysiological measurements from different parts of the brain} \guillemotright. In this case \Gls{pet} signal is used to observe coactivation of different regions of the brain. In this article \emph{Friston} uses the \Gls{pca} to investigate networks of functional connectivity. 


This method parallels the development of task based activation as mentioned in \niceRef{ssec::hrf}. By controlling the experimental condition, the brain is forced into a specific state. Based on correlation criteria, statistical tools such as \Gls{spm} allow to identify regions significantly associated to this state. From this seminal work of \emph{Karl Friston}, functional connectivity describes such statistical maps which are order two statistics. In this case networks are intrinsically associated to a task. 


In \cite{Biswal_1995}, for the first time, the study focuses on inter task period. For investigating \gls{mri} noise features \emph{Biswal} completed the classical task based (finger taping task) scheme with rest periods. After filtering out physiological confounds (respiratory and cardiac), a strong correlation is observed between bilateral regions timeseries during rest. In this article, the observed signal is compared to contemporary results obtained in rats \cite{Golanov_1994}, where spike trains in the cortex phase lock oscillations in the same frequency range ($\sim 0.1Hz$). This initial observation was made in the motor cortex, in the following years \emph{Biswal} confirms these initial findings in other regions, and other teams replicate the results \cite{Lowe_1998, Xiong_1999}. Overall, arguments converge to establish a physiological relevance for neuronal studies in this \emph{resting state functional connectivity} patterns \cite{Lowe_2010}. In a bit more than a decade this connectivity pattern during rest condition will become a reference method to evaluate brain functional network.  


        \subsubsection{The Default mode network}
        \label{ssec:Default-Mode-Network}


In early $2000s$ \cite{Raichle_2001} report a consistently deactivated cluster of regions during tasks. Based on previous findings from their team \cite{Shulman_1997}, they summarise \Gls{pet} observations which resonates with previous reports \cite{Friston_93} of regions whose activity increase at rest and disappear during tasks. This observation is confirmed in multiple cases (visual, acoustic, rest with eyes open or close) \cite{Franson_2006} and give rise to the concept of \emph{default mode network} which designs this specific cluster (containing the posterior and ventral anterior cingulate cortex ($PCC$, $vACC$), the precuneus $PC$ and the medial prefrontal cortex $mPFC$). Coupling the \Gls{rs-fc} approach with this new finding, \cite{Greicius_2003} shows that these regions also exert strong connectivity at rest. 


All together these findings are interpreted as follow \cite{Greicius_2003}:

\begin{enumerate}
    \item $PCC$, $vACC$, $PC$ and $mPFC$, part of the anatomical network appear strongly connected together.
    \item Under rest condition, when the brain tunes to default mode, this connectivity can be measured with \gls{fmri} in the form of a strongly coupled $\sim0.1Hz$ oscillation.
    \item This network deactivates when brain shifts states toward a task driven mode.
\end{enumerate}

In \emph{Greicius} terms it provides \guillemotleft the most compelling evidence to date for the existence of a cohesive, tonically active, default mode network. \guillemotright


We can now affirm that this \Gls{dmn} is only one of the multiple networks identified during resting state. In humans, \cite{Van_den_Heuvel_2010} reviews the main networks found in \emph{(a)} \cite{Biswal_1995}, \emph{(b)} \cite{Beckmann_2005}, \emph{(c)} \cite{DeLuca_2006}, \emph{(d)} \cite{damoiseaux_2006}, \emph{(e)} \cite{Salvador_2005}, \emph{(f)} \cite{Van_den_Heuvel_2008}. All together $8$ main networks associated to resting state are identified and mostly related to somatosensory regions (see: \niceFigRef{fig::default_mode_networks}): primary motor, primary visual, extra-striate visual, insular-temporal/ACC, left parietal-frontal, right parietal-frontal, default mode network and frontal network. These are usually refered to as \Gls{rsn}.


\begin{figure}[ht]
\begin{center}
    \includegraphics[width = \linewidth]{Content/01_Introduction/01_Introduction_Figures/resting_state_networks.jpg}
    \caption{Illustration of the main resting state netowrks identified by \Gls{ica} across six different studies from \cite{Van_den_Heuvel_2010}. These mode can be identified reliably across multiple cohorts with an unbiased method.}
    \label{fig::default_mode_networks}
\end{center}
\end{figure}


From these observation, researchers started to question the function of such covarying regions. The overlap with known function (visual regions, motor cortex...) is interpreted as anatomical relevance \cite{Van_den_Heuvel_2010}. The main model suggests that the underlying neuronal network imposes physical connection between regions far apart. During activity, task related regions show correlation related to the task. Outside of the stimulation the physical link remains. As a result spontaneous activations of neurons favourably propagate within this sub-network. The coactivating patterns observed around $0.1Hz$ would be triggered by this spontaneous propagation of information in the brain channelled in specific resting states networks. A potential mechanisms underlying these fluctuation has been presented in \niceRef{sssec:vasomotion}, where spontaneous vasomotion which oscillates with short distance coherence is tuned to local neuronal activity. The coactivation of neurons along these subnetworks would synchronise vascular tone along these axes and engender \gls{rs-fc} patterns \cite{Mateo2017-wp}.


The default mode network is a typical example and a most studied resting state network. Due to its peculiar functional role associated to rest, it has been a key target to understand the need of such an energy expending mechanism where rest would suggest energy saving. \cite{Greicius_2003} shows reduced connectivity within the \Gls{dmn} in the case of \emph{Alzheimer}'s disease patients. The salience network, composed of the dorsal anterior cingulate, bilateral orbitofrontal and insular cortices has been demonstrated to be of importance in behaviour control \cite{Pievani_2014}. Alternatively, the frontoparietal network is involved in memory, language and perception \cite{Pievani_2014}. It is now well accepted that these \Gls{rsn}s can be used as biomarkers of neurodegenerative diseases \cite{Filippi2019}.


        \subsubsection{Dynamic functional connectivity}
        \label{sssec:intro_dFC}


As we mentioned, the classical analysis of these pattern consists in extracting low-frequency oscillations ($<0.1Hz$) from the \Gls{bold} signal and study their covariance at the voxel or regional scale. The underlying hypothesis is the stationarity of these covarying structures. Overall this method measures what is called static functional connectivity. \cite{Calhoun_2014} describes the recent shift in methodology studying the non stationarity in these correlation patterns. \emph{Calhoun} identifies one of the first explicit mention of such dynamic functional connectivity in \cite{Sakoglu_2010}. In this case a clustering approach is applied on connectivity patterns computed on short windows ($44s$) evolution in time. The resulting clusters are associated to connectivity states. The temporal evolution of these states is then analysed. In \cite{Damaraju_2014}, it is shown that connectivity patterns absent from static analyses appear transiently in diseased states (in the case of schizophrenia). It is the purpose of \gls{dfc} to elicit such transient patterns. This dynamical approach opens new perspectives as the adaptability of brain function suggests a capacity to reorganise rapidly. From the framework of functional network  \niceRef{ssec:functional-network} transient activity can be expected in  \Gls{fc} patterns, which fails to be present when investigating \Gls{fc} on long periods. Once again, the question is one of scale and highlights how scale invariance is projected from the network structure to the temporal features. Nevertheless, it has been showed that the stationary hypothesis is valid, as static \Gls{fc} stabilises between $5$ and $6min$ \cite{Van_Dijk_2010}. Overall static \Gls{fc} is believed to represent features of the physical network, while local variation calls for the definition of transient brain states which are the target of dynamic \Gls{fc} \cite{Calhoun_2014}. Diseases have been associated to perturbations at both levels.


        \subsubsection{Coactivation Patterns}
        \label{sssec:intro_CAPS}


\begin{figure}[h]
\begin{center}
    \includesvg[width = \linewidth]{Content/01_Introduction/01_Introduction_Figures/intro_CAPs.svg}
    \caption{Illustration of \Gls{cap}s principle adapted from \cite{Gutierrez-Barragan_2019}. Top: principle of \Gls{cap}s ecomputation, frames are taken idependently and clustered with \emph{kmean} algorithm. Each cluster centroid makes one \Gls{cap}. Bottom: Left: example of typical \Gls{cap}s in anaesthetised mice, $6$ predominant \Gls{cap} explain $\sim 60\%$ of the signal variance. They can be associated by pair suggesting oscillatory underlying mechanism. Right: phase analysis of \Gls{cap} occurence relatively to global signal oscillation. Each \Gls{cap} occur preferably at a certain phase of \Gls{gs} oscillation.}
    \label{fig:intro-CAPs}
\end{center}
\end{figure}


More recently, in the follow up of dynamic functional connectivity, some teams focused on a way back to first level statistics. By identifying non stationary features of \Gls{fc}, \gls{dfc} highlights the interest in looking at transient phenomena explaining potential quick shifts in connectivity. \cite{Tagliazucchi_2011} proposes to define event in resting state signal by identifying peaks of \Gls{bold} \gls{fmri}. By doing so, usual \Gls{rsn} can be identified as the mean activation pattern during peaks of a seed signal. As detailed in \niceRef{sssec::intro-first-level}, usual \Gls{rsn} identification method relies on voxel wise correlation to a seed signal. \emph{Tagliazzuchi} shows that this correlation map overlaps with the average \Gls{bold} image taken from local maxima in the seed signal. In \cite{Liu_2013} the same approach is followed to study transient sources of nonstationnarity in the timeseries. As previously, a seed signal is extracted, for each high value of this signal the whole frame is extracted. Then all selected frames are classified. The centroid of each cluster defines a state assimilated to such \Gls{cap}. \cite{Gutierrez-Barragan_2019} applied this method to mice \Gls{fmri} in an unbiased fashion by removing frame selection. In this case they show that clustering all frames yields to the same results in terms of \Gls{cap}s definition. In other terms, by clustering all frames of a recording they found the same \Gls{cap}s as by selecting frames based on local maxima. By analysing the dynamics of these occurences, organised fluctuations can be found. They demonstrate that \Gls{cap}s follow a sequential activation pattern tuned on the global signal (even though causality of the effect remains unknown). In this framework, the brain would visit in a periodic fashion different states. It suggests an activation wave which propagates through the different regions. These results were lately confirmed in awake animals \cite{Gutierrez-Barragan_2022}. The same \Gls{cap}s were found, but the dynamic was different between awake and anaesthetised animals. In this article they show that different \Gls{cap}s dominate the signal during each conscious state. In this case, \Gls{cap}s can inform on state transitions in the system.


        \subsubsection{Summary}


To summarise the framework of functional connectivity, the brain is considered as a volume of organised complex matter. This system can be modelled as a network whose nodes would be elemental units of computation considered to be the neurons. Each neuron is acting as an integrator of the information it collects through numerous connections. The structure of the network is believed to be organised with some scaling properties. From these connections arise sub-networks that make the neuronal assemblies at the different scales. From this relatively fixed structure, tuning of the activity elicits some modes from which function arises. Based on the Hebbian principle, functional connectivity at its basic level is the measure of synchronicity between two nodes which represents the strength of their link. From this perspective, the brain is a dissipative system coupled with the environment. Interactions with this environment are perceived as energy influx, such as sensory inputs, which propagate along the functional network engendering an output, like behaviour. This behaviour is the result of the combination of both internal states and information content coming from the outside, both encoded in the functional connectivity. 


As the brain possess no energy reserve, it relies on a systemic delivery of energy through a particularly intricate vascular system and developed a tight coupling to maintain its homeostasis by a fine spatiotemporal regulation of blood supply. By transitivity, this neurovascular coupling creates a window, where synchronous haemodynamics are expected to represent a proxy for underlying functional connectivity. As such vascular signals can be measure in a non invasive fashion at an adequate spatiotemporal resolution with magnetic resonance imaging, this method has become the gold standard to make inference on brain network features. The first investigations were most interested in the sensory processing and the crystallisation of brain modes under stimulation, which was called task-based \gls{fmri}. Soon after was discovered an intrinsic patterned organisation of \gls{fmri} recordings by looking at the order two statistics of the haemodynamic signals. A finite number of resting states network have been identified whose modulation and interactions are believed to well represent the brain states. The classical way to observe these patterns is to compute these order two statistics over windows of typically $5-20min$. This type of analysis is called static functional connectivity. Alternatively, if the window is reduced, stationarity of the signal stands no more giving access to dynamical evolution of the synchronous patterns. This kind of analysis is called dynamic functional connectivity. Alternatively, many other tools have been developed to study the brain connectivity as measure by \gls{fmri}. One interesting attempt is the coactivation pattern methods that demonstrates dynamical organisation of first order statistics which are the mechanistic sources of functional connectivity. These objects give access to another type of dynamical descriptors of the network properties, and therefore potential quantitative observables of the brain state.
